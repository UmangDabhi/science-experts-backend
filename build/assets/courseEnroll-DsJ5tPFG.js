import{ad as i,ae as L,af as e,ag as R,ah as P,ai as f,aj as S,ak as O,h as M,d as u,r as c,a as k,o as D,j as n,s as A}from"./index-D92yZQ6n.js";import{u as F,P as U}from"./useRazorpayPayment-DZ28viXZ.js";import{R as I}from"./index-CmHb5i_P.js";import"./actions-BRAd6zMk.js";import"./index-7SQG4J1z.js";const G=i("enrollment/create_enrollment",R,e.CREATE_ENROLLMENT),z=i("enrollment/get_all_enrollments",f,s=>P(e.GET_ALL_ENROLLMENT,s));i(e.GET_ENROLLMENT,f,s=>e.GET_ENROLLMENT+"/"+s.id);i(e.UPDATE_ENROLLMENT,S,s=>e.UPDATE_ENROLLMENT+"/"+s.id);i(e.DELETE_ENROLLMENT,O,s=>e.DELETE_ENROLLMENT+"/"+s.id);const Y={enrollments:[],selectedEnrollment:{},totalEnrollments:0};L({name:"enrollment",initialState:Y,reducers:{resetEnrollmentSlice:s=>{s.enrollments=[],s.selectedEnrollment={},s.totalEnrollments=0},setEnrollment:(s,l)=>{s.selectedEnrollment=l.payload},deselectEnrollment:s=>{s.selectedEnrollment={}}},extraReducers:s=>{s.addCase(z.fulfilled,(l,a)=>{l.enrollments=a.payload.data.data,l.totalEnrollments=a.payload.data.total}).addCase(getCourseEnrollment.fulfilled,(l,a)=>{l.enrollments=a.payload.data})}});const Q=()=>{var x,h,p,E;const{dispatch:s}=A,{courseId:l}=M(),{selectedCourse:a,courses:B}=u(t=>t.course),{userDetails:r}=u(t=>t.auth),{initiatePayment:N,razorpayDivRef:H}=F(),[j,o]=c.useState(!1),[d,b]=c.useState(!1),{showToast:g}=k(),y=()=>{o(!0),N({useCoins:d,type:U.COURSE,itemId:a==null?void 0:a.id,name:a==null?void 0:a.title,description:a==null?void 0:a.description,user:{name:r.name,email:r.email,contact:r.phone_no||""},onSuccess:t=>{g("Enrollment Success!")}}).finally(()=>o(!1))},T=()=>{o(!0),s(G({course:l}))};c.useEffect(()=>{l&&w()},[l]);const w=()=>{s(D({id:l}))},m=((x=a==null?void 0:a.reviews)==null?void 0:x.reduce((t,v)=>t+v.rating,0))/((h=a==null?void 0:a.reviews)==null?void 0:h.length)||5,_=((p=a==null?void 0:a.enrollments)==null?void 0:p.length)||0;return n.jsxs("div",{children:[n.jsxs("div",{className:"bg-[#313131] w-full h-120 p-5 ",children:[n.jsxs("div",{className:"my-4 flex ",children:[n.jsx("div",{className:"w-64  h-auto border-2 rounded-xl border-white border-solid",children:n.jsx("img",{className:" rounded-xl",src:a==null?void 0:a.thumbnail_url,alt:"Course Thumbnail Image"})}),n.jsx("div",{className:"bg-[#313131] flex row-span-2 p-4  text-white",children:n.jsxs("div",{className:"  flex flex-col justify-between ",children:[n.jsx("h3",{className:"text-4xl",children:a==null?void 0:a.title}),n.jsxs("p",{children:["Instructor: ",(E=a==null?void 0:a.tutor)==null?void 0:E.name]}),n.jsxs("p",{children:["Last Updated on ",a==null?void 0:a.updated_at]}),n.jsx("p",{children:"English, Gujarati"}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("span",{children:m}),n.jsx(I,{className:"px-1",value:m,disabled:!0,allowHalf:!0}),n.jsxs("span",{children:["(",_,")"]})]})]})})]}),n.jsxs("div",{className:`bg-[#666666] rounded-xl p-3 ${(a==null?void 0:a.discount)!==0?"h-20":"h-14"} text-white  flex flex-col justify-between`,children:[(a==null?void 0:a.discount)!==0?n.jsxs("p",{className:"text-center",children:[a==null?void 0:a.discount," % discount"]}):"",n.jsxs("p",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"w-5 h-5 bg-white rounded-full relative",children:n.jsx("span",{className:"w-3 h-3 bg-[#FF8F18] rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})}),n.jsxs("span",{children:["₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100," Only"]})]}),n.jsxs("span",{className:"bg-[#00B73D] px-2 py-1 rounded-md",children:[(a==null?void 0:a.price)*(a==null?void 0:a.discount)/100," Saved"]})]})]})]}),n.jsxs("div",{className:"p-6 font-bold",children:[n.jsxs("p",{className:"text-2xl flex justify-between items-center",children:[n.jsx("span",{children:"Summary"}),n.jsxs("div",{className:"flex",children:[n.jsx("div",{className:"flex items-center",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{id:"useCoins",type:"checkbox",value:d,onChange:t=>b(t.target.checked),className:"accent-[#FF6200] h-4 w-4 transform scale-150"}),n.jsx("label",{htmlFor:"useCoins",className:"mx-3 text-xl",children:"Use My Coins"})]})}),n.jsx("button",{onClick:a!=null&&a.is_paid?y:T,disabled:j,className:"border-2 border-black rounded-3xl bg-[#FF8400] px-3 py-1 text-lg",children:a!=null&&a.is_paid?"Purchase Now":"Enroll Now"})]})]}),n.jsxs("p",{className:"text-xl ",children:["Total: ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100]}),n.jsxs("p",{children:["No refunds or credits for partial course periods unless required by law. Your course access begins immediately upon purchase with an initial charge of ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100,'. To avoid additional charges, cancel before the start of any future billing periods. By clicking "Start Course" you agree to our Terms and authorize recurring charges for future access.']})]})]})};export{Q as default};
