import{v as w,d as g,r as u,a as S,u as T,B as I,aC as U,aB as v,E as A,F as q,G as E,j as p,s as j,w as P,aD as D,aE as L}from"./index-SPnFrvr_.js";import{D as R}from"./DynamicForm-1e2kvtcI.js";import{C as o}from"./CommonClass-Dpx7ipLY.js";import{u as b}from"./uploadFile-In0CDFKR.js";const $=()=>{const{dispatch:l}=j,{courseId:m,materialId:n}=w(),{categories:C}=g(a=>a.category),{standards:F}=g(a=>a.standard),{languages:M}=g(a=>a.language),{selectedMaterial:e}=g(a=>a.material),[f,h]=u.useState({}),{showToast:x}=S(),y=T(),i=u.useRef(),{setStatus:c}=I(),_=[{name:"title",label:"Material Title",type:"text",required:!0,inputClass:o.COMMON_INPUT,maxLength:100},{name:"description",label:"Description",type:"textarea",inputClass:o.COMMON_INPUT,required:!0},{name:"thumbnail_url",label:"Thumbnail URL",inputClass:o.COMMON_INPUT,type:"file",required:!1,accept:".jpg,.jpeg,.png",onFileChange:a=>{const t={file:a[0],folder:"Material/Thumbnails"};c(!0),l(b(t)).unwrap().then(r=>{var s,d;i.current.resetForm({...f,thumbnail_url:(d=(s=r==null?void 0:r.data)==null?void 0:s.data)==null?void 0:d.s3Url})}).finally(()=>{c(!1)})}},{name:"material_url",label:"Material",type:"file",inputClass:o.COMMON_INPUT,required:!0,accept:".pdf",onFileChange:a=>{const t={file:a[0],folder:"Material/Materials"};c(!0),l(b(t)).unwrap().then(r=>{var s,d;i.current.resetForm({...f,material_url:(d=(s=r==null?void 0:r.data)==null?void 0:s.data)==null?void 0:d.s3Url})}).finally(()=>{c(!1)})}},{name:"language",label:"Language",inputClass:o.COMMON_INPUT,type:"select",required:!0,options:M.map(a=>({label:a.language,value:a.id}))},{name:"categories",label:"Categories",inputClass:"bg-[#F4F4F4] border-3 border-[#222]  ",type:"multi-select",required:!0,options:C.map(a=>({label:a.category,value:a.id}))},{name:"standards",label:"Standards",inputClass:"bg-[#F4F4F4] border-3 border-[#222]  ",type:"multi-select",required:!0,options:F.map(a=>({label:a.standard,value:a.id}))},{name:"amount",label:"Amount",inputClass:o.COMMON_INPUT,required:!0,type:"number",min:0}],N=a=>{const t=P({...a,course:m!=="-"?m:null,amount:parseInt(a.amount),language:a.language});l((n?D:L)(t)).unwrap().then(s=>{y(`/material/${m!=="-"?m:""}`),x(s.message,"success")})},O=u.useCallback(a=>{h(t=>({...t,...a}))},[]);return u.useEffect(()=>{l(n?U({id:n}):v({id:n}))},[n]),u.useEffect(()=>{if(i.current&&n){const a={id:e.id,title:e.title,description:e.description,thumbnail_url:e.thumbnail_url,material_url:e.material_url,amount:e.amount};e.categories&&(a.categories=[...e.categories].map(t=>t.id)),e.standards&&(a.standards=[...e.standards].map(t=>t.id)),e.language&&(a.language=e.language.id),i.current.resetForm({...a})}else i.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,material_url:null,amount:null,categories:null,standards:null,language:null})},[e]),u.useEffect(()=>{l(A({})),l(q({})),l(E({}))},[]),p.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-[#FFDBC4E5] rounded-2xl shadow-formShadow my-10 border border-[#FFA167]",children:[p.jsx("h1",{className:"text-3xl font-bold text-center text-[#FF6200] mb-8",children:"Add Material"}),p.jsx(R,{ref:i,formConfig:_,onSubmit:N,handleFieldChange:O,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#FF6200] !hover:bg-[#FF62000A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"})]})};export{$ as default};
