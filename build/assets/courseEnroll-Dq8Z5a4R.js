import{aB as r,aC as S,A as n,aD as k,aE as M,az as y,aF as v,aG as A,C as D,f as g,r as u,a as U,u as F,aH as $,N as z,as as B,e as G,j as s,b as C,s as H}from"./index-pNvrWSmY.js";import{C as I}from"./CourseDetailHeader-D9EjQ1tX.js";import{u as Y,P as q}from"./useRazorpayPayment-CqoGuP9T.js";import"./Icons-SYyy8jH9.js";import"./index-CD8KK78h.js";import"./ContextIsolator-DrMfFJ7f.js";import"./index-CSUN6ZqK.js";import"./index-D2mLwxQq.js";import"./actions-DOmdXVJ5.js";const V=r("enrollment/create_enrollment",k,n.CREATE_ENROLLMENT),W=r("enrollment/get_all_enrollments",y,a=>M(n.GET_ALL_ENROLLMENT,a));r(n.GET_ENROLLMENT,y,a=>n.GET_ENROLLMENT+"/"+a.id);r(n.UPDATE_ENROLLMENT,v,a=>n.UPDATE_ENROLLMENT+"/"+a.id);r(n.DELETE_ENROLLMENT,A,a=>n.DELETE_ENROLLMENT+"/"+a.id);const J={enrollments:[],selectedEnrollment:{},totalEnrollments:0};S({name:"enrollment",initialState:J,reducers:{resetEnrollmentSlice:a=>{a.enrollments=[],a.selectedEnrollment={},a.totalEnrollments=0},setEnrollment:(a,t)=>{a.selectedEnrollment=t.payload},deselectEnrollment:a=>{a.selectedEnrollment={}}},extraReducers:a=>{a.addCase(W.fulfilled,(t,e)=>{t.enrollments=e.payload.data.data,t.totalEnrollments=e.payload.data.total}).addCase(getCourseEnrollment.fulfilled,(t,e)=>{t.enrollments=e.payload.data})}});const re=()=>{var N;const{dispatch:a}=H,{courseId:t}=D(),{selectedCourse:e,courses:K}=g(l=>l.course),{userDetails:i}=g(l=>l.auth),{initiatePayment:L,razorpayDivRef:Q}=Y(),[_,c]=u.useState(!1),[p,j]=u.useState(!1),{showToast:d}=U(),R=F(),{openPrompt:P}=$(),b=()=>{c(!0),L({useCoins:p,type:q.COURSE,itemId:e==null?void 0:e.id,name:e==null?void 0:e.title,description:e==null?void 0:e.description,user:{name:i.name,email:i.email,contact:i.phone_no||""},onSuccess:l=>{E(),d("Enrollment Success!")}}).finally(()=>c(!1))},w=()=>{c(!0),a(V({course:t})).unwrap().then(o=>{d(o.message),setTimeout(()=>{var T;R(`/course/view/${e==null?void 0:e.id}/module/${(T=e==null?void 0:e.modules[0])==null?void 0:T.id}`)},500)}).catch(o=>{d((o==null?void 0:o.message)||"Enrollment Failed","error")}).finally(()=>{c(!1),E()})},O=()=>{if(!i){P();return}e!=null&&e.is_paid?b():w()};u.useEffect(()=>{t&&E()},[t]);const E=()=>{a(z({id:t}))};B(e);const{theme:h}=G(),m=!!(e!=null&&e.is_paid),x=!!(e!=null&&e.is_enrolled),f=(e==null?void 0:e.price)*(100-(e==null?void 0:e.discount))/100;return s.jsxs("div",{children:[s.jsx(I,{selectedCourse:e,isEnroll:!0}),s.jsxs("div",{className:"p-6 font-bold",children:[s.jsxs("p",{className:"text-2xl flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[s.jsx("span",{children:"Summary"}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:gap-4",children:[!x&&m&&s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{id:"useCoins",type:"checkbox",checked:p,onChange:l=>j(l.target.checked),className:"accent-[#F68713] h-4 w-4 transform scale-150"}),s.jsx("label",{htmlFor:"useCoins",className:"mx-3 text-xl",children:"Use My Coins"})]}),x?s.jsx(C,{className:`px-5 py-3 text-xl ${h.COLOR_BUTTON}`,to:`/course/view/${e==null?void 0:e.id}/module/${(N=e==null?void 0:e.modules[0])==null?void 0:N.id}`,children:"View Now"}):s.jsx("button",{onClick:O,disabled:_,className:`px-5 py-3 text-xl ${h.COLOR_BUTTON}`,children:m?"Purchase Now":"Enroll Now"})]})]}),s.jsx("p",{className:"text-xl mt-4",children:m?s.jsxs(s.Fragment,{children:["Total: ₹ ",f]}):s.jsx("span",{className:"text-primary font-semibold",children:"Free to Enroll"})}),m?s.jsxs("p",{children:["No refunds or credits for partial course periods unless required by law. Your course access begins immediately upon purchase with an initial charge of ₹ ",f,'. To avoid additional charges, cancel before the start of any future billing periods. By clicking "Start Course" you agree to our Terms and authorize recurring charges for future access.']}):s.jsx("p",{children:'This course is free to enroll. Click "Enroll Now" to get instant access!'})]})]})};export{re as default};
