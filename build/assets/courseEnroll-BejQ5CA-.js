import{aq as r,ar as j,A as n,as as O,at as P,au as h,av as R,aw as b,w,e as p,r as c,a as M,ax as S,C as v,al as k,d as A,j as t,b as D,s as U}from"./index-BjzhHNWB.js";import{C as I}from"./CourseDetailHeader-DRgLKKoO.js";import{u as $,P as z}from"./useRazorpayPayment-Brq9aSQM.js";import"./Icons-Z2-HRxj7.js";import"./index-BrAdIzSo.js";import"./index-D62oXebL.js";import"./index-BWe-oDl7.js";import"./actions-BZcaKrbk.js";const B=r("enrollment/create_enrollment",O,n.CREATE_ENROLLMENT),G=r("enrollment/get_all_enrollments",h,e=>P(n.GET_ALL_ENROLLMENT,e));r(n.GET_ENROLLMENT,h,e=>n.GET_ENROLLMENT+"/"+e.id);r(n.UPDATE_ENROLLMENT,R,e=>n.UPDATE_ENROLLMENT+"/"+e.id);r(n.DELETE_ENROLLMENT,b,e=>n.DELETE_ENROLLMENT+"/"+e.id);const Y={enrollments:[],selectedEnrollment:{},totalEnrollments:0};j({name:"enrollment",initialState:Y,reducers:{resetEnrollmentSlice:e=>{e.enrollments=[],e.selectedEnrollment={},e.totalEnrollments=0},setEnrollment:(e,s)=>{e.selectedEnrollment=s.payload},deselectEnrollment:e=>{e.selectedEnrollment={}}},extraReducers:e=>{e.addCase(G.fulfilled,(s,a)=>{s.enrollments=a.payload.data.data,s.totalEnrollments=a.payload.data.total}).addCase(getCourseEnrollment.fulfilled,(s,a)=>{s.enrollments=a.payload.data})}});const C=()=>{var u;const{dispatch:e}=U,{courseId:s}=w(),{selectedCourse:a,courses:q}=p(l=>l.course),{userDetails:o}=p(l=>l.auth),{initiatePayment:x,razorpayDivRef:F}=$(),[N,i]=c.useState(!1),[m,f]=c.useState(!1),{showToast:T}=M(),{openPrompt:L}=S(),_=()=>{i(!0),x({useCoins:m,type:z.COURSE,itemId:a==null?void 0:a.id,name:a==null?void 0:a.title,description:a==null?void 0:a.description,user:{name:o.name,email:o.email,contact:o.phone_no||""},onSuccess:l=>{d(),T("Enrollment Success!")}}).finally(()=>i(!1))},y=()=>{i(!0),e(B({course:s}))},g=()=>{if(!o){L();return}a!=null&&a.is_paid?_():y()};c.useEffect(()=>{s&&d()},[s]);const d=()=>{e(v({id:s}))};k(a);const{theme:E}=A();return t.jsxs("div",{children:[t.jsx(I,{selectedCourse:a,isEnroll:!0}),t.jsxs("div",{className:"p-6 font-bold",children:[t.jsxs("p",{className:"text-2xl flex justify-between items-center",children:[t.jsx("span",{children:"Summary"}),t.jsxs("div",{className:"flex",children:[!(a!=null&&a.is_enrolled)&&t.jsx("div",{className:"flex items-center",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{id:"useCoins",type:"checkbox",value:m,onChange:l=>f(l.target.checked),className:"accent-[#F68713] h-4 w-4 transform scale-150"}),t.jsx("label",{htmlFor:"useCoins",className:"mx-3 text-xl",children:"Use My Coins"})]})}),a!=null&&a.is_enrolled?t.jsx(D,{className:`px-5 py-3 text-xl ${E.COLOR_BUTTON}`,to:`/course/view/${a==null?void 0:a.id}/module/${(u=a==null?void 0:a.modules[0])==null?void 0:u.id}`,children:"View Now"}):t.jsx("button",{onClick:g,disabled:N,className:`px-5 py-3 text-xl ${E.COLOR_BUTTON}`,children:a!=null&&a.is_paid?"Purchase Now":"Enroll Now"})]})]}),t.jsxs("p",{className:"text-xl ",children:["Total: ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100]}),t.jsxs("p",{children:["No refunds or credits for partial course periods unless required by law. Your course access begins immediately upon purchase with an initial charge of ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100,'. To avoid additional charges, cancel before the start of any future billing periods. By clicking "Start Course" you agree to our Terms and authorize recurring charges for future access.']})]})]})};export{C as default};
