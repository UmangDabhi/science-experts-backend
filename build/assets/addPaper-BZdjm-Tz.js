import{C as _,f as o,r as u,a as F,u as P,K as S,e as w,aU as q,bY as v,P as A,Q as j,S as T,j as p,s as E,G as U,bZ as k,b_ as I}from"./index-BHBvR4s_.js";import{D as N}from"./DynamicForm-BM92xfs2.js";const L=()=>{const{dispatch:l}=E,{paperId:n}=_(),{categories:c}=o(e=>e.category),{standards:g}=o(e=>e.standard),{languages:m}=o(e=>e.language),{selectedPaper:a}=o(e=>e.paper),[s,b]=u.useState({}),{showToast:r}=F(),f=P(),i=u.useRef(),{uploadFile:d}=S();w();const h=[{name:"title",label:"Paper Title",type:"text",required:!0,inputClass:"input-class",maxLength:100},{name:"description",label:"Description",type:"textarea",inputClass:"input-class",required:!0},{name:"thumbnail_url",label:"Thumbnail URL",inputClass:"input-class",type:"file",accept:".jpg,.jpeg,.png",onFileChange:async e=>{if(!e[0])return r("Select a file first!");try{const t=await d(e[0],"Paper/Thumbnails");i.current.resetForm({...s,thumbnail_url:t}),r("File Uploaded Successfully")}catch{r("Something Went Wrong")}}},{name:"paper_url",label:"Paper",type:"file",inputClass:"input-class",required:!0,accept:".pdf",onFileChange:async e=>{if(!e[0])return r("Select a file first!");try{const t=await d(e[0],"Paper/Papers");i.current.resetForm({...s,paper_url:t}),r("File Uploaded Successfully")}catch{r("Something Went Wrong")}}},{name:"language",label:"Language",inputClass:"input-class",type:"select",required:!0,options:m.map(e=>({label:e.language,value:e.id}))},{name:"categories",label:"Categories",inputClass:"bg-white border-3 border-[#222]  ",type:"multi-select",required:!0,options:c.map(e=>({label:e.category,value:e.id}))},{name:"standards",label:"Standards",inputClass:"bg-white border-3 border-[#222]  ",type:"multi-select",required:!0,options:g.map(e=>({label:e.standard,value:e.id}))},{name:"is_paid",label:"Is Paid?",type:"checkbox",required:!1},{name:"amount",label:"Amount",inputClass:"input-class",type:"number",required:s==null?void 0:s.is_paid,min:0,hidden:!(s!=null&&s.is_paid)}],y=e=>{const t=U({...e,language:e.language,is_paid:e.is_paid||!1});e.amount&&(t.amount=parseInt(e.amount)),l((n?k:I)(t)).unwrap().then(C=>{f("/paperList"),r(C.message,"success")})},x=u.useCallback(e=>{b(t=>({...t,...e}))},[]);return u.useEffect(()=>{l(n?q({id:n}):v({id:n}))},[n]),u.useEffect(()=>{if(i.current&&n){const e={id:a.id,title:a.title,description:a.description,thumbnail_url:a.thumbnail_url,paper_url:a.paper_url,is_paid:a.is_paid,amount:a.amount};a.categories&&(e.categories=[...a.categories].map(t=>t.id)),a.standards&&(e.standards=[...a.standards].map(t=>t.id)),a.language&&(e.language=a.language.id),i.current.resetForm({...e})}else i.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,paper_url:null,amount:null,is_paid:null,categories:null,standards:null,language:null})},[a]),u.useEffect(()=>{l(A({})),l(j({})),l(T({}))},[]),p.jsxs("div",{className:"max-w-6xl mx-auto p-6 rounded-2xl shadow-formShadow my-10 border border-[#FFA167] gradient-bg",children:[p.jsx("h1",{className:" text-3xl font-bold text-center text-[#F68713] mb-8",children:"Add Paper"}),p.jsx(N,{ref:i,formConfig:h,onSubmit:y,handleFieldChange:x,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#F68713] !hover:bg-[#F687130A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"})]})};export{L as default};
