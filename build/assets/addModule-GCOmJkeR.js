import{w as M,e as w,r,a as y,u as S,B as N,d as T,S as v,T as O,j as n,s as I,U,x as V,V as j,W as D}from"./index-DB2EwENR.js";import{D as A}from"./DynamicForm-FIKimo0Y.js";import{C as i}from"./CommonClass-DJyhl18r.js";const k=()=>{const{dispatch:u}=I,{courseId:d,moduleId:a}=M(),{selectedModule:s}=w(e=>e.module),[c,h]=r.useState({}),{showToast:o}=y(),[f,m]=r.useState(null),_=S(),l=r.useRef(),{uploadFile:p}=N(),{theme:b}=T(),g=[{name:"title",label:"Module Title",type:"text",required:!0,inputClass:i.COMMON_INPUT,maxLength:100},{name:"description",label:"Description",type:"textarea",inputClass:i.COMMON_INPUT,required:!0},{name:"thumbnail_url",label:"Thumbnail",type:"file",inputClass:i.COMMON_INPUT,required:!0,accept:".jpg,.jpeg,.png",onFileChange:async e=>{if(!e[0])return o("Select a file first!");try{const t=await p(e[0],"Module/Thumbnails");l.current.resetForm({...c,thumbnail_url:t}),o("File Uploaded Successfully")}catch{o("Something Went Wrong")}}},{name:"video_url",label:"Video",type:"file",inputClass:i.COMMON_INPUT,required:!0,accept:".mp4,.webm",onFileChange:async e=>{if(U(e[0]).then(t=>{m(t)}),!e[0])return o("Select a file first!");try{const t=await p(e[0],"Module/Video");l.current.resetForm({...c,video_url:t}),o("File Uploaded Successfully")}catch{o("Something Went Wrong")}}},{name:"is_free_to_watch",label:"Is Free To Watch?",type:"checkbox",required:!1}],x=e=>{const t=V({...e,course:d,is_free_to_watch:JSON.parse(e.is_free_to_watch)});t.video_url?t.duration=parseFloat(f):delete t.duration,u((a?j:D)(t)).unwrap().then(F=>{_(`/courses/module/${d}`),o(F.message,"success")})},C=r.useCallback(e=>{h(t=>({...t,...e}))},[]);return r.useEffect(()=>{u(a?v({id:a}):O({id:a}))},[a]),r.useEffect(()=>{if(l.current&&a){const e={id:s.id,title:s.title,description:s.description,thumbnail_url:s.thumbnail_url,video_url:s.video_url,is_free_to_watch:s.is_free_to_watch};m(s.duration),l.current.resetForm({...e})}else l.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,video_url:null,is_free_to_watch:null})},[s]),n.jsxs("div",{className:`max-w-6xl mx-auto p-6 rounded-2xl shadow-formShadow my-10 border border-[#FFA167] ${b.GRADIENT_BG}`,children:[n.jsx("h1",{className:" text-3xl font-bold text-center text-[#F68713] mb-8",children:"Add Module"}),n.jsx(A,{ref:l,formConfig:g,onSubmit:x,handleFieldChange:C,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#F68713] !hover:bg-[#F687130A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"})]})};export{k as default};
