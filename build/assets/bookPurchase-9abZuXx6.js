import{z as C,f as u,r as a,aD as E,a as S,aO as T,e as k,aP as L,j as b,s as j}from"./index-CYgJ5ZTk.js";import{u as v,P as z}from"./useRazorpayPayment-BzzLQ8Nk.js";import{a as I,P as J}from"./PurchasePreviewComponent-DowlNe4B.js";import"./actions-DG5SgnAG.js";import"./index-BU0u-q5C.js";import"./ContextIsolator-BKvLsOSU.js";import"./index-B7v7tR-V.js";import"./index-GvTkkyb0.js";const B=()=>{const{dispatch:m}=j,{bookId:t}=C(),{selectedBook:s,books:O}=u(o=>o.book),{initiatePayment:p,razorpayDivRef:R}=v(),{initiateDownload:f,isLoading:d}=I(),[l,e]=a.useState(!1),[n,P]=a.useState(!1),{openPrompt:i}=E(),{userDetails:r}=u(o=>o.auth),{showToast:h}=S(),D=()=>{if(!r){i();return}e(!0),p({useCoins:n,type:z.BOOK,itemId:s==null?void 0:s.id,name:s==null?void 0:s.title,description:s==null?void 0:s.description,user:{name:"John Doe",email:"John Doe",contact:"John Doe"},onSuccess:o=>{c(),h("Purchase Success!")}}).finally(()=>e(!1))};a.useEffect(()=>{t&&c()},[t]);const g=(o,x)=>{if(!r){i();return}f(o,x)},c=()=>{m(T({id:t}))};k();const{rating:w,views:y}=L(s);return b.jsx(J,{selectedItem:s,rating:w,views:y,useCoins:n,setUseCoins:P,handlePurchaseClick:D,handleDownloadClick:g,loading:l,downloadLoading:d})};export{B as default};
