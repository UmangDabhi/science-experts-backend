import{v as y,d as N,r as u,a as v,u as O,y as S,N as T,O as I,j as m,s as j,Q as D,w as U,S as V,T as q}from"./index-BuvaiK4F.js";import{D as A}from"./DynamicForm-D8HdTfzX.js";import{C as c}from"./CommonClass-Dpx7ipLY.js";import{u as h}from"./uploadFile-BCilxn1B.js";const B=()=>{const{dispatch:i}=j,{courseId:p,moduleId:s}=y(),{selectedModule:l}=N(e=>e.module),[f,b]=u.useState({}),{showToast:F}=v(),[g,_]=u.useState(null),x=O(),r=u.useRef(),{setStatus:d}=S(),C=[{name:"title",label:"Module Title",type:"text",required:!0,inputClass:c.COMMON_INPUT,maxLength:100},{name:"description",label:"Description",type:"textarea",inputClass:c.COMMON_INPUT,required:!0},{name:"thumbnail_url",label:"Thumbnail",type:"file",inputClass:c.COMMON_INPUT,required:!0,accept:".jpg,.jpeg,.png",onFileChange:e=>{const t={file:e[0],folder:"Module/Thumbnails"};d(!0),i(h(t)).unwrap().then(a=>{var o,n;r.current.resetForm({...f,thumbnail_url:(n=(o=a==null?void 0:a.data)==null?void 0:o.data)==null?void 0:n.s3Url})}).finally(()=>{d(!1)})}},{name:"video_url",label:"Video",type:"file",inputClass:c.COMMON_INPUT,required:!0,accept:".mp4,.mkv",onFileChange:e=>{const t={file:e[0],folder:"Module/Video"};d(!0),D(e[0]).then(a=>{_(a)}),i(h(t)).unwrap().then(a=>{var o,n;r.current.resetForm({...f,video_url:(n=(o=a==null?void 0:a.data)==null?void 0:o.data)==null?void 0:n.s3Url})}).finally(()=>{d(!1)})}},{name:"is_free_to_watch",label:"Is Free To Watch?",type:"checkbox",required:!1}],M=e=>{const t=U({...e,course:p,is_free_to_watch:JSON.parse(e.is_free_to_watch)});t.video_url?t.duration=parseFloat(g):delete t.duration,i((s?V:q)(t)).unwrap().then(o=>{x(`/courses/module/${p}`),F(o.message,"success")})},w=u.useCallback(e=>{b(t=>({...t,...e}))},[]);return u.useEffect(()=>{i(s?T({id:s}):I({id:s}))},[s]),u.useEffect(()=>{if(r.current&&s){const e={id:l.id,title:l.title,description:l.description,thumbnail_url:l.thumbnail_url,video_url:l.video_url,is_free_to_watch:l.is_free_to_watch};_(l.duration),r.current.resetForm({...e})}else r.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,video_url:null,is_free_to_watch:null})},[l]),m.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-[#FFDBC4E5] rounded-2xl shadow-formShadow my-10 border border-[#FFA167]",children:[m.jsx("h1",{className:"text-3xl font-bold text-center text-[#FF6200] mb-8",children:"Add Module"}),m.jsx(A,{ref:r,formConfig:C,onSubmit:M,handleFieldChange:w,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#FF6200] !hover:bg-[#FF62000A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"})]})};export{B as default};
