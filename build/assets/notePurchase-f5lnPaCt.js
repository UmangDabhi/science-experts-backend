import{C as E,f as u,r as a,aH as T,a as x,aO as L,e as R,aR as S,j as I,s as j}from"./index-BHBvR4s_.js";import{u as v,P as A}from"./useRazorpayPayment-C5jDv7mI.js";import{u as J,P as N}from"./PurchasePreviewComponent-y7HMGb0L.js";import"./actions-D13KjOuA.js";import"./index-C1kapGRz.js";import"./ContextIsolator-r72C00t8.js";import"./index-Crai6NJu.js";import"./index-B3FzYEoF.js";const F=()=>{const{dispatch:m}=j,{materialId:o}=E(),{selectedMaterial:s,materials:k}=u(t=>t.material),{initiatePayment:p,razorpayDivRef:z}=v(),{initiateDownload:f,isLoading:d}=J(),[l,e]=a.useState(!1),[n,h]=a.useState(!1),{openPrompt:i}=T(),{userDetails:r}=u(t=>t.auth),{showToast:P}=x(),D=()=>{if(!r){i();return}e(!0),p({useCoins:n,type:A.MATERIAL,itemId:s==null?void 0:s.id,name:s==null?void 0:s.title,description:s==null?void 0:s.description,user:{name:"John Doe",email:"John Doe",contact:"John Doe"},onSuccess:t=>{c(),P("Purchase Success!")}}).finally(()=>e(!1))};a.useEffect(()=>{o&&c()},[o]);const g=(t,C)=>{if(!r){i();return}f(t,C)},c=()=>{m(L({id:o}))};R();const{rating:w,views:y}=S(s);return I.jsx(N,{selectedItem:s,rating:w,views:y,useCoins:n,setUseCoins:h,handlePurchaseClick:D,handleDownloadClick:g,loading:l,downloadLoading:d})};export{F as default};
