import{e as C,c as v,r as n,u as A,w as j,x as M,j as d,s as T,y as D,o as V,z as S,A as q}from"./index-CRih-8pH.js";import{D as E}from"./DynamicForm-Ct_qjGl9.js";import{u as N}from"./useToast-D87k8Puz.js";import{u as f}from"./uploadFile-DnQFdHQO.js";import{T as I}from"./Toast-Ch7gPG5F.js";const J=()=>{const{dispatch:u}=T,{courseId:c,moduleId:a}=C(),{selectedModule:r}=v(e=>e.module),[m,F]=n.useState({}),{toasts:h,showToast:b}=N(),[x,p]=n.useState(null),g=A(),l=n.useRef(),_=[{name:"title",label:"Module Title",type:"text",required:!0,inputClass:" border border-[#FFA167] focus:outline-none focus:ring-1 focus:ring-[#FF6200] focus:border-[#FF6200] text-[#333] placeholder-[#888] rounded-xl shadow-md px-4 py-2 transition duration-200 ease-in-out",maxLength:100},{name:"description",label:"Description",type:"textarea",inputClass:" border border-[#FFA167] focus:outline-none focus:ring-1 focus:ring-[#FF6200] focus:border-[#FF6200] text-[#333] placeholder-[#888] rounded-xl shadow-md px-4 py-2 transition duration-200 ease-in-out",required:!0},{name:"thumbnail_url",label:"Thumbnail",type:"file",inputClass:" border border-[#FFA167] focus:outline-none focus:ring-1 focus:ring-[#FF6200] focus:border-[#FF6200] text-[#333] placeholder-[#888] rounded-xl shadow-md px-4 py-2 transition duration-200 ease-in-out",required:!1,accept:".jpg,.jpeg,.png",onFileChange:e=>{const o={file:e[0],folder:"Thumbnails"};u(f(o)).unwrap().then(t=>{var s,i;l.current.resetForm({...m,thumbnail_url:(i=(s=t==null?void 0:t.data)==null?void 0:s.data)==null?void 0:i.s3Url})})}},{name:"video_url",label:"Video",type:"file",inputClass:" border border-[#FFA167] focus:outline-none focus:ring-1 focus:ring-[#FF6200] focus:border-[#FF6200] text-[#333] placeholder-[#888] rounded-xl shadow-md px-4 py-2 transition duration-200 ease-in-out",required:!0,accept:".mp4,.mkv",onFileChange:e=>{const o={file:e[0],folder:"Video"};D(e[0]).then(t=>{p(t)}),u(f(o)).unwrap().then(t=>{var s,i;l.current.resetForm({...m,video_url:(i=(s=t==null?void 0:t.data)==null?void 0:s.data)==null?void 0:i.s3Url})})}},{name:"is_free_to_watch",label:"Is Free To Watch?",type:"checkbox",required:!1}],w=e=>{const o=V({...e,course:c,is_free_to_watch:JSON.parse(e.is_free_to_watch)});o.video_url?o.duration=parseFloat(x):delete o.duration,u((a?S:q)(o)).unwrap().then(s=>{g(`/courses/module/${c}`),b(s.message,"success")})},y=n.useCallback(e=>{F(o=>({...o,...e}))},[]);return n.useEffect(()=>{u(a?j({id:a}):M({id:a}))},[a]),n.useEffect(()=>{if(l.current&&a){const e={id:r.id,title:r.title,description:r.description,thumbnail_url:r.thumbnail_url,video_url:r.video_url,is_free_to_watch:r.is_free_to_watch};p(r.duration),l.current.resetForm({...e})}else l.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,video_url:null,is_free_to_watch:null})},[r]),d.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-[#FFDBC4E5] rounded-2xl shadow-formShadow my-10 border border-[#FFA167]",children:[d.jsx("h1",{className:"text-3xl font-bold text-center text-[#FF6200] mb-8",children:"Add Module"}),d.jsx(E,{ref:l,formConfig:_,onSubmit:w,handleFieldChange:y,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#FF6200] !hover:bg-[#FF62000A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"}),d.jsx(I,{toasts:h})]})};export{J as default};
