import{v as N,d,r as i,a as _,u as S,z as O,aE as w,aD as T,C as I,D as U,E as v,j as c,s as A,w as q,aF as E,aG as j}from"./index-CmF4KgW5.js";import{D as P}from"./DynamicForm-DGAKXoeT.js";import{C as u}from"./CommonClass-Dpx7ipLY.js";const L=()=>{const{dispatch:r}=A,{courseId:o,materialId:s}=N(),{categories:p}=d(e=>e.category),{standards:b}=d(e=>e.standard),{languages:f}=d(e=>e.language),{selectedMaterial:a}=d(e=>e.material),[m,C]=i.useState({}),{showToast:l}=_(),F=S(),n=i.useRef(),{uploadFile:g}=O(),h=[{name:"title",label:"Note Title",type:"text",required:!0,inputClass:u.COMMON_INPUT,maxLength:100},{name:"description",label:"Description",type:"textarea",inputClass:u.COMMON_INPUT,required:!0},{name:"thumbnail_url",label:"Thumbnail URL",inputClass:u.COMMON_INPUT,type:"file",required:!0,accept:".jpg,.jpeg,.png",onFileChange:async e=>{if(!e[0])return l("Select a file first!");try{const t=await g(e[0],"Material/Thumbnails");n.current.resetForm({...m,thumbnail_url:t}),l("File Uploaded Successfully")}catch{l("Something Went Wrong")}}},{name:"material_url",label:"Material",type:"file",inputClass:u.COMMON_INPUT,required:!0,accept:".pdf",onFileChange:async e=>{if(!e[0])return l("Select a file first!");try{const t=await g(e[0],"Material/Materials");n.current.resetForm({...m,material_url:t}),l("File Uploaded Successfully")}catch{l("Something Went Wrong")}}},{name:"language",label:"Language",inputClass:u.COMMON_INPUT,type:"select",required:!0,options:f.map(e=>({label:e.language,value:e.id}))},{name:"categories",label:"Categories",inputClass:"bg-[#F4F4F4] border-3 border-[#222]  ",type:"multi-select",required:!0,options:p.map(e=>({label:e.category,value:e.id}))},{name:"standards",label:"Standards",inputClass:"bg-[#F4F4F4] border-3 border-[#222]  ",type:"multi-select",required:!0,options:b.map(e=>({label:e.standard,value:e.id}))},{name:"amount",label:"Amount",inputClass:u.COMMON_INPUT,required:!0,type:"number",min:0}],M=e=>{const t=q({...e,course:o!=="-"?o:null,amount:parseInt(e.amount),language:e.language});r((s?E:j)(t)).unwrap().then(x=>{F(`/material/${o!=="-"?o:""}`),l(x.message,"success")})},y=i.useCallback(e=>{C(t=>({...t,...e}))},[]);return i.useEffect(()=>{r(s?w({id:s}):T({id:s}))},[s]),i.useEffect(()=>{if(n.current&&s){const e={id:a.id,title:a.title,description:a.description,thumbnail_url:a.thumbnail_url,material_url:a.material_url,amount:a.amount};a.categories&&(e.categories=[...a.categories].map(t=>t.id)),a.standards&&(e.standards=[...a.standards].map(t=>t.id)),a.language&&(e.language=a.language.id),n.current.resetForm({...e})}else n.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,material_url:null,amount:null,categories:null,standards:null,language:null})},[a]),i.useEffect(()=>{r(I({})),r(U({})),r(v({}))},[]),c.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-[#FFDBC4E5] rounded-2xl shadow-formShadow my-10 border border-[#FFA167]",children:[c.jsx("h1",{className:"text-3xl font-bold text-center text-[#FF6200] mb-8",children:"Add Note"}),c.jsx(P,{ref:n,formConfig:h,onSubmit:M,handleFieldChange:y,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#FF6200] !hover:bg-[#FF62000A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"})]})};export{L as default};
