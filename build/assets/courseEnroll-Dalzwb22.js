import{aw as r,ax as j,A as s,ay as R,az as O,aA as h,aB as P,aC as b,w,f as p,r as c,a as S,aD as M,K as A,ar as k,e as v,j as t,b as D,s as U}from"./index-DTy30a3Z.js";import{C as z}from"./CourseDetailHeader-i7In4fCN.js";import{u as B,P as $}from"./useRazorpayPayment-CVUcNgNl.js";import"./Icons-CM0IsjOP.js";import"./index-BI0nt5hw.js";import"./ContextIsolator-DCsTuVGd.js";import"./index-BKf-VVpj.js";import"./index-vdMU6tb6.js";import"./actions-4UEewJ6Z.js";const G=r("enrollment/create_enrollment",R,s.CREATE_ENROLLMENT),I=r("enrollment/get_all_enrollments",h,e=>O(s.GET_ALL_ENROLLMENT,e));r(s.GET_ENROLLMENT,h,e=>s.GET_ENROLLMENT+"/"+e.id);r(s.UPDATE_ENROLLMENT,P,e=>s.UPDATE_ENROLLMENT+"/"+e.id);r(s.DELETE_ENROLLMENT,b,e=>s.DELETE_ENROLLMENT+"/"+e.id);const Y={enrollments:[],selectedEnrollment:{},totalEnrollments:0};j({name:"enrollment",initialState:Y,reducers:{resetEnrollmentSlice:e=>{e.enrollments=[],e.selectedEnrollment={},e.totalEnrollments=0},setEnrollment:(e,n)=>{e.selectedEnrollment=n.payload},deselectEnrollment:e=>{e.selectedEnrollment={}}},extraReducers:e=>{e.addCase(I.fulfilled,(n,a)=>{n.enrollments=a.payload.data.data,n.totalEnrollments=a.payload.data.total}).addCase(getCourseEnrollment.fulfilled,(n,a)=>{n.enrollments=a.payload.data})}});const aa=()=>{var u;const{dispatch:e}=U,{courseId:n}=w(),{selectedCourse:a,courses:F}=p(l=>l.course),{userDetails:o}=p(l=>l.auth),{initiatePayment:x,razorpayDivRef:H}=B(),[f,i]=c.useState(!1),[m,N]=c.useState(!1),{showToast:T}=S(),{openPrompt:L}=M(),y=()=>{i(!0),x({useCoins:m,type:$.COURSE,itemId:a==null?void 0:a.id,name:a==null?void 0:a.title,description:a==null?void 0:a.description,user:{name:o.name,email:o.email,contact:o.phone_no||""},onSuccess:l=>{d(),T("Enrollment Success!")}}).finally(()=>i(!1))},_=()=>{i(!0),e(G({course:n}))},g=()=>{if(!o){L();return}a!=null&&a.is_paid?y():_()};c.useEffect(()=>{n&&d()},[n]);const d=()=>{e(A({id:n}))};k(a);const{theme:E}=v();return t.jsxs("div",{children:[t.jsx(z,{selectedCourse:a,isEnroll:!0}),t.jsxs("div",{className:"p-6 font-bold",children:[t.jsxs("p",{className:"text-2xl flex justify-between items-center",children:[t.jsx("span",{children:"Summary"}),t.jsxs("div",{className:"flex",children:[!(a!=null&&a.is_enrolled)&&t.jsx("div",{className:"flex items-center",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{id:"useCoins",type:"checkbox",value:m,onChange:l=>N(l.target.checked),className:"accent-[#F68713] h-4 w-4 transform scale-150"}),t.jsx("label",{htmlFor:"useCoins",className:"mx-3 text-xl",children:"Use My Coins"})]})}),a!=null&&a.is_enrolled?t.jsx(D,{className:`px-5 py-3 text-xl ${E.COLOR_BUTTON}`,to:`/course/view/${a==null?void 0:a.id}/module/${(u=a==null?void 0:a.modules[0])==null?void 0:u.id}`,children:"View Now"}):t.jsx("button",{onClick:g,disabled:f,className:`px-5 py-3 text-xl ${E.COLOR_BUTTON}`,children:a!=null&&a.is_paid?"Purchase Now":"Enroll Now"})]})]}),t.jsxs("p",{className:"text-xl ",children:["Total: ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100]}),t.jsxs("p",{children:["No refunds or credits for partial course periods unless required by law. Your course access begins immediately upon purchase with an initial charge of ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100,'. To avoid additional charges, cancel before the start of any future billing periods. By clicking "Start Course" you agree to our Terms and authorize recurring charges for future access.']})]})]})};export{aa as default};
