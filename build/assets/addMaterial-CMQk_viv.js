import{v as O,d,r as u,a as w,u as T,B as I,aC as U,aB as S,E as v,F as A,j as g,s as E,w as j,aD as q,aE as P}from"./index-CElKK0FW.js";import{D}from"./DynamicForm-DmcWgPyV.js";import{C as o}from"./CommonClass-Dpx7ipLY.js";import{u as b}from"./uploadFile-NJXfMQUJ.js";const k=()=>{const{dispatch:r}=E,{courseId:c,materialId:i}=O(),{categories:C}=d(e=>e.category),{languages:M}=d(e=>e.language),{selectedMaterial:a}=d(e=>e.material),[p,h]=u.useState({}),{showToast:F}=w(),x=T(),n=u.useRef(),{setStatus:f}=I(),_=[{name:"title",label:"Material Title",type:"text",required:!0,inputClass:o.COMMON_INPUT,maxLength:100},{name:"description",label:"Description",type:"textarea",inputClass:o.COMMON_INPUT,required:!0},{name:"thumbnail_url",label:"Thumbnail URL",inputClass:o.COMMON_INPUT,type:"file",required:!1,accept:".jpg,.jpeg,.png",onFileChange:e=>{const t={file:e[0],folder:"Material/Thumbnails"};r(b(t)).unwrap().then(l=>{var s,m;n.current.resetForm({...p,thumbnail_url:(m=(s=l==null?void 0:l.data)==null?void 0:s.data)==null?void 0:m.s3Url})})}},{name:"material_url",label:"Material",type:"file",inputClass:o.COMMON_INPUT,required:!0,accept:".pdf",onFileChange:e=>{const t={file:e[0],folder:"Material/Materials"};f(!0),r(b(t)).unwrap().then(l=>{var s,m;n.current.resetForm({...p,material_url:(m=(s=l==null?void 0:l.data)==null?void 0:s.data)==null?void 0:m.s3Url})}).finally(()=>{f(!1)})}},{name:"language",label:"Language",inputClass:o.COMMON_INPUT,type:"select",required:!0,options:M.map(e=>({label:e.language,value:e.id}))},{name:"categories",label:"Categories",inputClass:"bg-[#F4F4F4] border-3 border-[#222]  ",type:"multi-select",required:!0,options:C.map(e=>({label:e.category,value:e.id}))},{name:"amount",label:"Amount",inputClass:o.COMMON_INPUT,required:!0,type:"number",min:0}],y=e=>{const t=j({...e,course:c!=="-"?c:null,amount:parseInt(e.amount),language:e.language});r((i?q:P)(t)).unwrap().then(s=>{x(`/material/${c!=="-"?c:""}`),F(s.message,"success")})},N=u.useCallback(e=>{h(t=>({...t,...e}))},[]);return u.useEffect(()=>{r(i?U({id:i}):S({id:i}))},[i]),u.useEffect(()=>{if(n.current&&i){const e={id:a.id,title:a.title,description:a.description,thumbnail_url:a.thumbnail_url,material_url:a.material_url,amount:a.amount};a.categories&&(e.categories=[...a.categories].map(t=>t.id)),a.language&&(e.language=a.language.id),n.current.resetForm({...e})}else n.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,material_url:null,amount:null,categories:null,language:null})},[a]),u.useEffect(()=>{r(v({})),r(A({}))},[]),g.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-[#FFDBC4E5] rounded-2xl shadow-formShadow my-10 border border-[#FFA167]",children:[g.jsx("h1",{className:"text-3xl font-bold text-center text-[#FF6200] mb-8",children:"Add Material"}),g.jsx(D,{ref:n,formConfig:_,onSubmit:y,handleFieldChange:N,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#FF6200] !hover:bg-[#FF62000A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"})]})};export{k as default};
