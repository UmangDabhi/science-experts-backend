import{C as S,f as u,r as a,aH as T,a as x,aS as E,e as k,aT as L,j as b,s as j}from"./index-pNvrWSmY.js";import{u as v,P as I}from"./useRazorpayPayment-CqoGuP9T.js";import{a as J,P as R}from"./PurchasePreviewComponent-Bq-1T0Mp.js";import"./actions-DOmdXVJ5.js";import"./index-CD8KK78h.js";import"./ContextIsolator-DrMfFJ7f.js";import"./index-CSUN6ZqK.js";import"./index-D2mLwxQq.js";const q=()=>{const{dispatch:m}=j,{bookId:t}=S(),{selectedBook:s,books:z}=u(o=>o.book),{initiatePayment:p,razorpayDivRef:M}=v(),{initiateDownload:f,isLoading:d}=J(),[l,e]=a.useState(!1),[n,h]=a.useState(!1),{openPrompt:i}=T(),{userDetails:r}=u(o=>o.auth),{showToast:P}=x(),D=()=>{if(!r){i();return}e(!0),p({useCoins:n,type:I.BOOK,itemId:s==null?void 0:s.id,name:s==null?void 0:s.title,description:s==null?void 0:s.description,user:{name:"John Doe",email:"John Doe",contact:"John Doe"},onSuccess:o=>{c(),P("Purchase Success!")}}).finally(()=>e(!1))};a.useEffect(()=>{t&&c()},[t]);const g=(o,C)=>{if(!r){i();return}f(o,C)},c=()=>{m(E({id:t}))};k();const{rating:w,views:y}=L(s);return b.jsx(R,{selectedItem:s,rating:w,views:y,useCoins:n,setUseCoins:h,handlePurchaseClick:D,handleDownloadClick:g,loading:l,downloadLoading:d})};export{q as default};
