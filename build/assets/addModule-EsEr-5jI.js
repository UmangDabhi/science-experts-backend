import{w as F,f as w,r,a as y,u as C,J as v,e as S,Y as M,Z as j,j as u,s as T,$ as V,F as D,a0 as q,a1 as N}from"./index-CNXByAnQ.js";import{D as W}from"./DynamicForm-BWp3u4dc.js";const I=()=>{const{dispatch:i}=T,{courseId:n,moduleId:l}=F(),{selectedModule:s}=w(e=>e.module),[d,p]=r.useState({}),{showToast:a}=y(),[h,c]=r.useState(null),f=C(),o=r.useRef(),{uploadFile:m}=v();S();const _=[{name:"title",label:"Module Title",type:"text",required:!0,inputClass:"input-class",maxLength:100},{name:"description",label:"Description",type:"textarea",inputClass:"input-class",required:!0},{name:"thumbnail_url",label:"Thumbnail",type:"file",inputClass:"input-class",required:!0,accept:".jpg,.jpeg,.png",onFileChange:async e=>{if(!e[0])return a("Select a file first!");try{const t=await m(e[0],"Module/Thumbnails");o.current.resetForm({...d,thumbnail_url:t}),a("File Uploaded Successfully")}catch{a("Something Went Wrong")}}},{name:"video_url",label:"Video",type:"file",inputClass:"input-class",required:!0,accept:".mp4,.webm",onFileChange:async e=>{if(V(e[0]).then(t=>{c(t)}),!e[0])return a("Select a file first!");try{const t=await m(e[0],"Module/Video");o.current.resetForm({...d,video_url:t}),a("File Uploaded Successfully")}catch{a("Something Went Wrong")}}},{name:"is_free_to_watch",label:"Is Free To Watch?",type:"checkbox",required:!1}],g=e=>{const t=D({...e,course:n,is_free_to_watch:JSON.parse(e.is_free_to_watch)});t.video_url?t.duration=parseFloat(h):delete t.duration,i((l?q:N)(t)).unwrap().then(x=>{f(`/courses/module/${n}`),a(x.message,"success")})},b=r.useCallback(e=>{p(t=>({...t,...e}))},[]);return r.useEffect(()=>{i(l?M({id:l}):j({id:l}))},[l]),r.useEffect(()=>{if(o.current&&l){const e={id:s.id,title:s.title,description:s.description,thumbnail_url:s.thumbnail_url,video_url:s.video_url,is_free_to_watch:s.is_free_to_watch};c(s.duration),o.current.resetForm({...e})}else o.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,video_url:null,is_free_to_watch:null})},[s]),u.jsxs("div",{className:"max-w-6xl mx-auto p-6 rounded-2xl shadow-formShadow my-10 border border-[#FFA167] gradient-bg",children:[u.jsx("h1",{className:" text-3xl font-bold text-center text-[#F68713] mb-8",children:"Add Module"}),u.jsx(W,{ref:o,formConfig:_,onSubmit:g,handleFieldChange:b,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#F68713] !hover:bg-[#F687130A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"})]})};export{I as default};
