import{v as S,d as c,a as w,y as T,r,u as q,j as p,z as v,A as D,B as P,C as U,D as j,s as A,w as E,E as L,F as R}from"./index-8ZuSOXzc.js";import{D as k}from"./DynamicForm-Dv3lGhQX.js";import{J as B}from"./JoditEditorComponent-SWPwvXzS.js";import{C as l}from"./CommonClass-Dpx7ipLY.js";import{u as J}from"./uploadFile-BVmgtEDz.js";const W=()=>{const{dispatch:n}=A,{courseId:i}=S(),{categories:f}=c(e=>e.category),{standards:h}=c(e=>e.standard),{languages:F}=c(e=>e.language),{selectedCourse:s}=c(e=>e.course),{showToast:_}=w(),{setStatus:C}=T(),[t,x]=r.useState({}),[m,g]=r.useState(""),o=r.useRef(),y=q(),N=r.useCallback(e=>{g(e)},[]),M=[{name:"title",label:"Course Title",type:"text",required:!0,maxLength:100,inputClass:l.COMMON_INPUT},{name:"description",label:"Description",type:"textarea",inputClass:l.COMMON_INPUT,required:!0},{extra:p.jsx(B,{title:"Detail Description",content:m,onChange:N})},{name:"thumbnail_url",label:"Thumbnail URL",inputClass:l.COMMON_INPUT,type:"file",required:!0,accept:".jpg,.jpeg,.png",onFileChange:e=>{const a={file:e[0],folder:"Course/Thumbnails"};C(!0),n(J(a)).unwrap().then(u=>{var d,b;o.current.resetForm({...t,thumbnail_url:(b=(d=u==null?void 0:u.data)==null?void 0:d.data)==null?void 0:b.s3Url})}).finally(()=>{C(!1)})}},{name:"language",label:"Language",inputClass:l.COMMON_INPUT,type:"select",required:!0,options:F.map(e=>({label:e.language,value:e.id}))},{name:"categories",label:"Categories",inputClass:"bg-[#F4F4F4] border-3 border-[#222]  ",type:"multi-select",required:!0,options:f.map(e=>({label:e.category,value:e.id}))},{name:"standards",label:"Standards",inputClass:"bg-[#F4F4F4] border-3 border-[#222]  ",type:"multi-select",required:!0,options:h.map(e=>({label:e.standard,value:e.id}))},{name:"is_paid",label:"Is Paid?",type:"checkbox",required:!1},{name:"price",label:"Price",inputClass:l.COMMON_INPUT,type:"number",required:t==null?void 0:t.is_paid,min:0,hidden:!(t!=null&&t.is_paid)},{name:"discount",label:"Discount (%)",inputClass:l.COMMON_INPUT,type:"number",required:!1,min:0,max:100,hidden:!(t!=null&&t.is_paid)}],O=e=>{const a=E({id:e.id,title:e.title,description:e.description,categories:e.categories,standards:e.standards,is_paid:e.is_paid||!1,price:parseInt(e.price),discount:parseInt(e.discount),thumbnail_url:e.thumbnail_url,language:e.language});m&&(a.detail_description=m),n((i?L:R)(a)).unwrap().then(d=>{y("/courses/manage"),_(d.message,"success")})};r.useEffect(()=>{n(i?v({id:i}):D({id:i}))},[i]),r.useEffect(()=>{n(P({})),n(U({})),n(j({}))},[]);const I=r.useCallback(e=>{x(a=>({...a,...e}))},[]);return r.useEffect(()=>{if(o.current&&i){const e={id:s.id,title:s.title,description:s.description,is_paid:s.is_paid,price:parseInt(s.price),discount:s.discount,thumbnail_url:s.thumbnail_url};s.categories&&(e.categories=[...s.categories].map(a=>a.id)),s.standards&&(e.standards=[...s.standards].map(a=>a.id)),s.language&&(e.language=s.language.id),g(s.detail_description),o.current.resetForm({...e})}else o.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,is_paid:null,price:null,discount:null,categories:null,standards:null,language:null}),g(null)},[s]),p.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-[#FFDBC4E5] rounded-2xl shadow-formShadow my-10 border border-[#FFA167]",children:[p.jsx("h1",{className:" text-3xl font-bold text-center text-[#FF6200] mb-8",children:"Create New Course"}),p.jsx(k,{ref:o,formConfig:M,onSubmit:O,handleFieldChange:I,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#FF6200] !hover:bg-[#FF62000A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"})]})};export{W as default};
