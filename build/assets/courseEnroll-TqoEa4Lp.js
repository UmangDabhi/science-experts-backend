import{aq as r,ar as j,A as n,as as R,at as O,au as h,av as P,aw as b,x as S,e as p,r as c,a as w,ax as M,D as v,al as k,d as A,j as t,b as D,s as U}from"./index-Djrfb291.js";import{C as $}from"./CourseDetailHeader-1qgfY7hY.js";import{u as z,P as B}from"./useRazorpayPayment-BXAMYHbx.js";import"./Icons-CIZZET2y.js";import"./index-2f79Fvpf.js";import"./index-DxMnTIrD.js";import"./index-CR8UhKh5.js";import"./actions-BlCEllVa.js";const G=r("enrollment/create_enrollment",R,n.CREATE_ENROLLMENT),I=r("enrollment/get_all_enrollments",h,e=>O(n.GET_ALL_ENROLLMENT,e));r(n.GET_ENROLLMENT,h,e=>n.GET_ENROLLMENT+"/"+e.id);r(n.UPDATE_ENROLLMENT,P,e=>n.UPDATE_ENROLLMENT+"/"+e.id);r(n.DELETE_ENROLLMENT,b,e=>n.DELETE_ENROLLMENT+"/"+e.id);const Y={enrollments:[],selectedEnrollment:{},totalEnrollments:0};j({name:"enrollment",initialState:Y,reducers:{resetEnrollmentSlice:e=>{e.enrollments=[],e.selectedEnrollment={},e.totalEnrollments=0},setEnrollment:(e,s)=>{e.selectedEnrollment=s.payload},deselectEnrollment:e=>{e.selectedEnrollment={}}},extraReducers:e=>{e.addCase(I.fulfilled,(s,a)=>{s.enrollments=a.payload.data.data,s.totalEnrollments=a.payload.data.total}).addCase(getCourseEnrollment.fulfilled,(s,a)=>{s.enrollments=a.payload.data})}});const C=()=>{var u;const{dispatch:e}=U,{courseId:s}=S(),{selectedCourse:a,courses:q}=p(l=>l.course),{userDetails:o}=p(l=>l.auth),{initiatePayment:x,razorpayDivRef:F}=z(),[f,i]=c.useState(!1),[m,N]=c.useState(!1),{showToast:T}=w(),{openPrompt:L}=M(),_=()=>{i(!0),x({useCoins:m,type:B.COURSE,itemId:a==null?void 0:a.id,name:a==null?void 0:a.title,description:a==null?void 0:a.description,user:{name:o.name,email:o.email,contact:o.phone_no||""},onSuccess:l=>{d(),T("Enrollment Success!")}}).finally(()=>i(!1))},y=()=>{i(!0),e(G({course:s}))},g=()=>{if(!o){L();return}a!=null&&a.is_paid?_():y()};c.useEffect(()=>{s&&d()},[s]);const d=()=>{e(v({id:s}))};k(a);const{theme:E}=A();return t.jsxs("div",{children:[t.jsx($,{selectedCourse:a,isEnroll:!0}),t.jsxs("div",{className:"p-6 font-bold",children:[t.jsxs("p",{className:"text-2xl flex justify-between items-center",children:[t.jsx("span",{children:"Summary"}),t.jsxs("div",{className:"flex",children:[!(a!=null&&a.is_enrolled)&&t.jsx("div",{className:"flex items-center",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{id:"useCoins",type:"checkbox",value:m,onChange:l=>N(l.target.checked),className:"accent-[#F68713] h-4 w-4 transform scale-150"}),t.jsx("label",{htmlFor:"useCoins",className:"mx-3 text-xl",children:"Use My Coins"})]})}),a!=null&&a.is_enrolled?t.jsx(D,{className:`px-5 py-3 text-xl ${E.COLOR_BUTTON}`,to:`/course/view/${a==null?void 0:a.id}/module/${(u=a==null?void 0:a.modules[0])==null?void 0:u.id}`,children:"View Now"}):t.jsx("button",{onClick:g,disabled:f,className:`px-5 py-3 text-xl ${E.COLOR_BUTTON}`,children:a!=null&&a.is_paid?"Purchase Now":"Enroll Now"})]})]}),t.jsxs("p",{className:"text-xl ",children:["Total: ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100]}),t.jsxs("p",{children:["No refunds or credits for partial course periods unless required by law. Your course access begins immediately upon purchase with an initial charge of ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100,'. To avoid additional charges, cancel before the start of any future billing periods. By clicking "Start Course" you agree to our Terms and authorize recurring charges for future access.']})]})]})};export{C as default};
