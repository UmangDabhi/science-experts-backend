import{x as F,e as d,r as i,a as N,u as S,C as B,d as M,aI as O,bA as T,F as w,G as I,H as A,j as c,s as U,y as q,bB as v,bC as P}from"./index-eS-IgJE9.js";import{D as j}from"./DynamicForm-buxuD3lt.js";import{C as u}from"./CommonClass-DJyhl18r.js";const W=()=>{const{dispatch:l}=U,{bookId:n}=F(),{categories:g}=d(e=>e.category),{standards:p}=d(e=>e.standard),{languages:b}=d(e=>e.language),{selectedBook:a}=d(e=>e.book),[s,f]=i.useState({}),{showToast:o}=N(),h=S(),r=i.useRef(),{uploadFile:m}=B(),{theme:C}=M(),_=[{name:"title",label:"Book Title",type:"text",required:!0,inputClass:u.COMMON_INPUT,maxLength:100},{name:"description",label:"Description",type:"textarea",inputClass:u.COMMON_INPUT,required:!0},{name:"thumbnail_url",label:"Thumbnail URL",inputClass:u.COMMON_INPUT,type:"file",accept:".jpg,.jpeg,.png",onFileChange:async e=>{if(!e[0])return o("Select a file first!");try{const t=await m(e[0],"Book/Thumbnails");r.current.resetForm({...s,thumbnail_url:t}),o("File Uploaded Successfully")}catch{o("Something Went Wrong")}}},{name:"book_url",label:"Book",type:"file",inputClass:u.COMMON_INPUT,required:!0,accept:".pdf",onFileChange:async e=>{if(!e[0])return o("Select a file first!");try{const t=await m(e[0],"Book/Books");r.current.resetForm({...s,book_url:t}),o("File Uploaded Successfully")}catch{o("Something Went Wrong")}}},{name:"language",label:"Language",inputClass:u.COMMON_INPUT,type:"select",required:!0,options:b.map(e=>({label:e.language,value:e.id}))},{name:"categories",label:"Categories",inputClass:"bg-white border-3 border-[#222]  ",type:"multi-select",required:!0,options:g.map(e=>({label:e.category,value:e.id}))},{name:"standards",label:"Standards",inputClass:"bg-white border-3 border-[#222]  ",type:"multi-select",required:!0,options:p.map(e=>({label:e.standard,value:e.id}))},{name:"is_paid",label:"Is Paid?",type:"checkbox",required:!1},{name:"amount",label:"Amount",inputClass:u.COMMON_INPUT,type:"number",required:s==null?void 0:s.is_paid,min:0,hidden:!(s!=null&&s.is_paid)}],k=e=>{const t=q({...e,language:e.language,is_paid:e.is_paid||!1});e.amount&&(t.amount=parseInt(e.amount)),l((n?v:P)(t)).unwrap().then(x=>{h("/bookList"),o(x.message,"success")})},y=i.useCallback(e=>{f(t=>({...t,...e}))},[]);return i.useEffect(()=>{l(n?O({id:n}):T({id:n}))},[n]),i.useEffect(()=>{if(r.current&&n){const e={id:a.id,title:a.title,description:a.description,thumbnail_url:a.thumbnail_url,book_url:a.book_url,is_paid:a.is_paid,amount:a.amount};a.categories&&(e.categories=[...a.categories].map(t=>t.id)),a.standards&&(e.standards=[...a.standards].map(t=>t.id)),a.language&&(e.language=a.language.id),r.current.resetForm({...e})}else r.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,book_url:null,amount:null,is_paid:null,categories:null,standards:null,language:null})},[a]),i.useEffect(()=>{l(w({})),l(I({})),l(A({}))},[]),c.jsxs("div",{className:`max-w-6xl mx-auto p-6 rounded-2xl shadow-formShadow my-10 border border-[#FFA167] ${C.GRADIENT_BG}`,children:[c.jsx("h1",{className:" text-3xl font-bold text-center text-[#F68713] mb-8",children:"Add Book"}),c.jsx(j,{ref:r,formConfig:_,onSubmit:k,handleFieldChange:y,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#F68713] !hover:bg-[#F687130A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"})]})};export{W as default};
