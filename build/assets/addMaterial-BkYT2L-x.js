import{C as F,f as u,r as n,a as S,u as w,K as _,e as M,aO as q,aN as A,P as j,Q as v,S as N,j as d,s as T}from"./index-BjdLfJe7.js";import{D as E}from"./DynamicForm-D8J3R9EV.js";import{s as R}from"./materialService-1TVc-bSy.js";const D=()=>{const{dispatch:l}=T,{courseId:o,materialId:r}=F(),{categories:g}=u(e=>e.category),{standards:p}=u(e=>e.standard),{languages:b}=u(e=>e.language),{selectedMaterial:a}=u(e=>e.material),[c,f]=n.useState({}),{showToast:s}=S(),h=w(),i=n.useRef(),{uploadFile:m}=_();M();const y=[{name:"title",label:"Note Title",type:"text",required:!0,inputClass:"input-class",maxLength:100},{name:"description",label:"Description",type:"textarea",inputClass:"input-class",required:!0},{name:"thumbnail_url",label:"Thumbnail URL",inputClass:"input-class",type:"file",required:!0,accept:".jpg,.jpeg,.png",onFileChange:async e=>{if(!e[0])return s("Select a file first!");try{const t=await m(e[0],"Material/Thumbnails");i.current.resetForm({...c,thumbnail_url:t}),s("File Uploaded Successfully")}catch{s("Something Went Wrong")}}},{name:"material_url",label:"Material",type:"file",inputClass:"input-class",required:!0,accept:".pdf",onFileChange:async e=>{if(!e[0])return s("Select a file first!");try{const t=await m(e[0],"Material/Materials");i.current.resetForm({...c,material_url:t}),s("File Uploaded Successfully")}catch{s("Something Went Wrong")}}},{name:"language",label:"Language",inputClass:"input-class",type:"select",required:!0,options:b.map(e=>({label:e.language,value:e.id}))},{name:"categories",label:"Categories",inputClass:"bg-white border-3 border-[#222]  ",type:"multi-select",required:!0,options:g.map(e=>({label:e.category,value:e.id}))},{name:"standards",label:"Standards",inputClass:"bg-white border-3 border-[#222]  ",type:"multi-select",required:!0,options:p.map(e=>({label:e.standard,value:e.id}))},{name:"amount",label:"Amount",inputClass:"input-class",required:!0,type:"number",min:0}],x=e=>{R({data:e,dispatch:l,courseId:o,materialId:r}).then(t=>{h(`/material/${o!=="-"?o:""}`),s(t.message,"success")}).catch(t=>{})},C=n.useCallback(e=>{f(t=>({...t,...e}))},[]);return n.useEffect(()=>{l(r?q({id:r}):A({id:r}))},[r]),n.useEffect(()=>{if(i.current&&r){const e={id:a.id,title:a.title,description:a.description,thumbnail_url:a.thumbnail_url,material_url:a.material_url,amount:a.amount};a.categories&&(e.categories=[...a.categories].map(t=>t.id)),a.standards&&(e.standards=[...a.standards].map(t=>t.id)),a.language&&(e.language=a.language.id),i.current.resetForm({...e})}else i.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,material_url:null,amount:null,categories:null,standards:null,language:null})},[a]),n.useEffect(()=>{l(j({})),l(v({})),l(N({}))},[]),d.jsxs("div",{className:"max-w-6xl mx-auto p-6 rounded-2xl shadow-formShadow my-10 border border-[#FFA167] gradient-bg",children:[d.jsx("h1",{className:" text-3xl font-bold text-center text-[#F68713] mb-8",children:"Add Note"}),d.jsx(E,{ref:i,formConfig:y,onSubmit:x,handleFieldChange:C,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#F68713] !hover:bg-[#F687130A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"})]})};export{D as default};
