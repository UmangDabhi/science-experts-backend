import{h as w,d as N,r as i,a as v,u as y,z as O,A as S,j as c,s as T,B as D,i as I,C as j,D as V}from"./index-D92yZQ6n.js";import{D as A}from"./DynamicForm-D8AzG-Db.js";import{C as d}from"./CommonClass-Dpx7ipLY.js";import{u as h}from"./uploadFile-DCucV8dy.js";const k=()=>{const{dispatch:u}=T,{courseId:m,moduleId:s}=w(),{selectedModule:o}=N(e=>e.module),[p,_]=i.useState({}),{showToast:b}=v(),[C,f]=i.useState(null),F=y(),r=i.useRef(),g=[{name:"title",label:"Module Title",type:"text",required:!0,inputClass:d.COMMON_INPUT,maxLength:100},{name:"description",label:"Description",type:"textarea",inputClass:d.COMMON_INPUT,required:!0},{name:"thumbnail_url",label:"Thumbnail",type:"file",inputClass:d.COMMON_INPUT,required:!1,accept:".jpg,.jpeg,.png",onFileChange:e=>{const t={file:e[0],folder:"Module/Thumbnails"};u(h(t)).unwrap().then(a=>{var l,n;r.current.resetForm({...p,thumbnail_url:(n=(l=a==null?void 0:a.data)==null?void 0:l.data)==null?void 0:n.s3Url})})}},{name:"video_url",label:"Video",type:"file",inputClass:d.COMMON_INPUT,required:!0,accept:".mp4,.mkv",onFileChange:e=>{const t={file:e[0],folder:"Module/Video"};D(e[0]).then(a=>{f(a)}),u(h(t)).unwrap().then(a=>{var l,n;r.current.resetForm({...p,video_url:(n=(l=a==null?void 0:a.data)==null?void 0:l.data)==null?void 0:n.s3Url})})}},{name:"is_free_to_watch",label:"Is Free To Watch?",type:"checkbox",required:!1}],x=e=>{const t=I({...e,course:m,is_free_to_watch:JSON.parse(e.is_free_to_watch)});t.video_url?t.duration=parseFloat(C):delete t.duration,u((s?j:V)(t)).unwrap().then(l=>{F(`/courses/module/${m}`),b(l.message,"success")})},M=i.useCallback(e=>{_(t=>({...t,...e}))},[]);return i.useEffect(()=>{u(s?O({id:s}):S({id:s}))},[s]),i.useEffect(()=>{if(r.current&&s){const e={id:o.id,title:o.title,description:o.description,thumbnail_url:o.thumbnail_url,video_url:o.video_url,is_free_to_watch:o.is_free_to_watch};f(o.duration),r.current.resetForm({...e})}else r.current.resetForm({id:null,title:null,description:null,thumbnail_url:null,video_url:null,is_free_to_watch:null})},[o]),c.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-[#FFDBC4E5] rounded-2xl shadow-formShadow my-10 border border-[#FFA167]",children:[c.jsx("h1",{className:"text-3xl font-bold text-center text-[#FF6200] mb-8",children:"Add Module"}),c.jsx(A,{ref:r,formConfig:g,onSubmit:x,handleFieldChange:M,gridClass:"grid grid-cols-1  gap-6",formClass:"space-y-8 w-full",submitClass:"!bg-[#FF6200] !hover:bg-[#FF62000A] text-white font-semibold px-6 py-3 rounded-xl shadow-lg transition duration-300"})]})};export{k as default};
