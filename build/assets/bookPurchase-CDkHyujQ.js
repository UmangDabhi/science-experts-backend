import{w as g,f as i,r as o,aD as y,a as x,aN as E,e as S,aO as T,j as w,s as C}from"./index-BIwGSPbH.js";import{u as b,P as j}from"./useRazorpayPayment-BdMGHzqF.js";import{P as v}from"./PurchasePreviewComponent-CUr_S0CG.js";import"./actions-BPR7LELw.js";import"./index-Py6jjhHR.js";import"./ContextIsolator-qG6bPkcN.js";import"./index-Dc2cs8cU.js";import"./index-DksuG98G.js";const A=()=>{const{dispatch:c}=C,{bookId:e}=g(),{selectedBook:s,books:I}=i(t=>t.book),{initiatePayment:u,razorpayDivRef:J}=b(),[m,a]=o.useState(!1),[r,p]=o.useState(!1),{openPrompt:f}=y(),{userDetails:P}=i(t=>t.auth),{showToast:h}=x(),l=()=>{if(!P){f();return}a(!0),u({useCoins:r,type:j.BOOK,itemId:s==null?void 0:s.id,name:s==null?void 0:s.title,description:s==null?void 0:s.description,user:{name:"John Doe",email:"John Doe",contact:"John Doe"},onSuccess:t=>{n(),h("Purchase Success!")}}).finally(()=>a(!1))};o.useEffect(()=>{e&&n()},[e]);const n=()=>{c(E({id:e}))};S();const{rating:d,views:D}=T(s);return w.jsx(v,{selectedItem:s,rating:d,views:D,useCoins:r,setUseCoins:p,handlePurchaseClick:l,loading:m})};export{A as default};
