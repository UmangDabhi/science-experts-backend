import{aa as d,ab as L,ac as e,ad as T,ae as R,af as g,ag as P,ah as O,r as p,s as w,e as k,c as D,i as z,j as n}from"./index-pR6HjcrU.js";import{a as S,v as A}from"./actions-DJEvfXiO.js";import{R as I}from"./index-DLd61USD.js";import"./index-CNWFqONu.js";const _=d("enrollment/create_enrollment",T,e.CREATE_ENROLLMENT),M=d("enrollment/get_all_enrollments",g,t=>R(e.GET_ALL_ENROLLMENT,t));d(e.GET_ENROLLMENT,g,t=>e.GET_ENROLLMENT+"/"+t.id);d(e.UPDATE_ENROLLMENT,P,t=>e.UPDATE_ENROLLMENT+"/"+t.id);d(e.DELETE_ENROLLMENT,O,t=>e.DELETE_ENROLLMENT+"/"+t.id);const F={enrollments:[],selectedEnrollment:{},totalEnrollments:0};L({name:"enrollment",initialState:F,reducers:{resetEnrollmentSlice:t=>{t.enrollments=[],t.selectedEnrollment={},t.totalEnrollments=0},setEnrollment:(t,r)=>{t.selectedEnrollment=r.payload},deselectEnrollment:t=>{t.selectedEnrollment={}}},extraReducers:t=>{t.addCase(M.fulfilled,(r,a)=>{r.enrollments=a.payload.data.data,r.totalEnrollments=a.payload.data.total}).addCase(getCourseEnrollment.fulfilled,(r,a)=>{r.enrollments=a.payload.data})}});const G=()=>{const{dispatch:t}=w,r=p.useRef(null);return p.useEffect(()=>{const l=document.createElement("script");l.src="https://checkout.razorpay.com/v1/checkout.js",l.async=!0,document.body.appendChild(l)},[]),{initiatePayment:async(l,h)=>{try{t(S({amount:l})).unwrap().then(s=>{const{id:x,currency:i,amount:u}=s.data.order,f={key:"rzp_live_BNwsmO8Ialy7ft",amount:u,currency:i,name:"Science Experts Course",description:"Payment for the course",order_id:x,handler:function(o){console.log(o),t(A(o)).unwrap().then(c=>{console.log(c),t(_({course:h}))}).catch(c=>{console.error("Error Verifying Payment:",c)})},prefill:{name:"John Doe",email:"john.doe@example.com",contact:"9876543210"},theme:{color:"#F37254"},modal:{backdropclose:!1}};new window.Razorpay(f).open()}).catch(s=>{console.error("Error initiating payment:",s)})}catch(s){console.error("Error initiating payment:",s)}},razorpayDivRef:r}},J=()=>{var E,N,j,b;const{dispatch:t}=w,{courseId:r}=k(),{selectedCourse:a,courses:l}=D(m=>m.course),{initiatePayment:h,razorpayDivRef:s}=G(),[x,i]=p.useState(!1),u=()=>{i(!0),h(a==null?void 0:a.price,a==null?void 0:a.id).finally(()=>i(!1))},f=()=>{i(!0),t(_({course:r}))};p.useEffect(()=>{r&&y()},[r]);const y=()=>{t(z({id:r}))},o=((E=a==null?void 0:a.review)==null?void 0:E.reduce((m,v)=>m+v.rating,0))/((N=a==null?void 0:a.review)==null?void 0:N.length)||0,c=((j=a==null?void 0:a.enrollments)==null?void 0:j.length)||0;return n.jsxs("div",{children:[n.jsxs("div",{className:"bg-[#313131] w-full h-120 p-5 ",children:[n.jsxs("div",{className:"my-4 flex ",children:[n.jsx("div",{className:"w-64  h-auto border-2 rounded-xl border-white border-solid",children:n.jsx("img",{className:" rounded-xl",src:a==null?void 0:a.thumbnail_url,alt:"Course Thumbnail Image"})}),n.jsx("div",{className:"bg-[#313131] flex row-span-2 p-4  text-white",children:n.jsxs("div",{className:"  flex flex-col justify-between ",children:[n.jsx("h3",{className:"text-4xl",children:a==null?void 0:a.title}),n.jsxs("p",{children:["Instructor: ",(b=a==null?void 0:a.tutor)==null?void 0:b.name]}),n.jsxs("p",{children:["Last Updated on ",a==null?void 0:a.updated_at]}),n.jsx("p",{children:"English, Gujarati"}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("span",{children:o}),n.jsx(I,{className:"px-1",value:o,disabled:!0,allowHalf:!0}),n.jsxs("span",{children:["(",c,")"]})]})]})})]}),n.jsxs("div",{className:`bg-[#666666] rounded-xl p-3 ${(a==null?void 0:a.discount)!==0?"h-20":"h-14"} text-white  flex flex-col justify-between`,children:[(a==null?void 0:a.discount)!==0?n.jsxs("p",{className:"text-center",children:[a==null?void 0:a.discount," % discount"]}):"",n.jsxs("p",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"w-5 h-5 bg-white rounded-full relative",children:n.jsx("span",{className:"w-3 h-3 bg-[#FF8F18] rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})}),n.jsxs("span",{children:["₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100," Only"]})]}),n.jsxs("span",{className:"bg-[#00B73D] px-2 py-1 rounded-md",children:[(a==null?void 0:a.price)*(a==null?void 0:a.discount)/100," Saved"]})]})]})]}),n.jsxs("div",{className:"p-6 font-bold",children:[n.jsxs("p",{className:"text-2xl flex justify-between items-center",children:[n.jsx("span",{children:"Summary"}),n.jsx("button",{onClick:a!=null&&a.is_paid?u:f,disabled:x,className:"border-2 border-black rounded-3xl bg-[#FF8400] px-3 py-1 text-lg",children:a!=null&&a.is_paid?"Purchase Now":"Enroll Now"})]}),n.jsxs("p",{className:"text-xl ",children:["Total: ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100]}),n.jsxs("p",{children:["No refunds or credits for partial course periods unless required by law. Your course access begins immediately upon purchase with an initial charge of ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100,'. To avoid additional charges, cancel before the start of any future billing periods. By clicking "Start Course" you agree to our Terms and authorize recurring charges for future access.']})]})]})};export{J as default};
