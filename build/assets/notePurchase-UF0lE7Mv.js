import{z as T,f as u,r as a,aD as x,a as C,aK as L,e as S,aN as I,j as N,s as R}from"./index-CYgJ5ZTk.js";import{u as j,P as v}from"./useRazorpayPayment-BzzLQ8Nk.js";import{u as z,P as A}from"./PurchasePreviewComponent-DowlNe4B.js";import"./actions-DG5SgnAG.js";import"./index-BU0u-q5C.js";import"./ContextIsolator-BKvLsOSU.js";import"./index-B7v7tR-V.js";import"./index-GvTkkyb0.js";const G=()=>{const{dispatch:m}=R,{materialId:o}=T(),{selectedMaterial:s,materials:J}=u(t=>t.material),{initiatePayment:p,razorpayDivRef:k}=j(),{initiateDownload:f,isLoading:d}=z(),[l,e]=a.useState(!1),[n,h]=a.useState(!1),{openPrompt:i}=x(),{userDetails:r}=u(t=>t.auth),{showToast:P}=C(),D=()=>{if(!r){i();return}e(!0),p({useCoins:n,type:v.MATERIAL,itemId:s==null?void 0:s.id,name:s==null?void 0:s.title,description:s==null?void 0:s.description,user:{name:"John Doe",email:"John Doe",contact:"John Doe"},onSuccess:t=>{c(),P("Purchase Success!")}}).finally(()=>e(!1))};a.useEffect(()=>{o&&c()},[o]);const g=(t,E)=>{if(!r){i();return}f(t,E)},c=()=>{m(L({id:o}))};S();const{rating:w,views:y}=I(s);return N.jsx(A,{selectedItem:s,rating:w,views:y,useCoins:n,setUseCoins:h,handlePurchaseClick:D,handleDownloadClick:g,loading:l,downloadLoading:d})};export{G as default};
