import{ar as i,as as v,A as t,at as P,au as R,av as f,aw as S,ax as k,w as M,e as E,r as c,a as O,ay as D,C as A,al as F,j as n,am as U,b as I,s as z}from"./index-Cbji9Z_j.js";import{u as G,P as Y}from"./useRazorpayPayment-DWHxM-F4.js";import{R as $}from"./index-hYv7Yi9D.js";import"./actions-1AedBkjj.js";import"./index-CqAPGmzH.js";import"./index-C_CFN-wi.js";const B=i("enrollment/create_enrollment",P,t.CREATE_ENROLLMENT),H=i("enrollment/get_all_enrollments",f,s=>R(t.GET_ALL_ENROLLMENT,s));i(t.GET_ENROLLMENT,f,s=>t.GET_ENROLLMENT+"/"+s.id);i(t.UPDATE_ENROLLMENT,S,s=>t.UPDATE_ENROLLMENT+"/"+s.id);i(t.DELETE_ENROLLMENT,k,s=>t.DELETE_ENROLLMENT+"/"+s.id);const q={enrollments:[],selectedEnrollment:{},totalEnrollments:0};v({name:"enrollment",initialState:q,reducers:{resetEnrollmentSlice:s=>{s.enrollments=[],s.selectedEnrollment={},s.totalEnrollments=0},setEnrollment:(s,l)=>{s.selectedEnrollment=l.payload},deselectEnrollment:s=>{s.selectedEnrollment={}}},extraReducers:s=>{s.addCase(H.fulfilled,(l,a)=>{l.enrollments=a.payload.data.data,l.totalEnrollments=a.payload.data.total}).addCase(getCourseEnrollment.fulfilled,(l,a)=>{l.enrollments=a.payload.data})}});const sa=()=>{var h,p,u;const{dispatch:s}=z,{courseId:l}=M(),{selectedCourse:a,courses:V}=E(e=>e.course),{userDetails:r}=E(e=>e.auth),{initiatePayment:N,razorpayDivRef:W}=G(),[j,o]=c.useState(!1),[d,b]=c.useState(!1),{showToast:g}=O(),{openPrompt:y}=D(),w=()=>{o(!0),N({useCoins:d,type:Y.COURSE,itemId:a==null?void 0:a.id,name:a==null?void 0:a.title,description:a==null?void 0:a.description,user:{name:r.name,email:r.email,contact:r.phone_no||""},onSuccess:e=>{m(),g("Enrollment Success!")}}).finally(()=>o(!1))},T=()=>{o(!0),s(B({course:l}))},L=()=>{if(!r){y();return}a!=null&&a.is_paid?w():T()};c.useEffect(()=>{l&&m()},[l]);const m=()=>{s(A({id:l}))},{rating:x,views:_,videos:J,duration:K}=F(a);return n.jsxs("div",{children:[n.jsxs("div",{className:"bg-[#313131] w-full h-120 p-5 ",children:[n.jsxs("div",{className:"my-4 flex ",children:[n.jsx("div",{className:"w-64  h-auto border-2 rounded-xl border-white border-solid",children:n.jsx("img",{className:" rounded-xl",src:a==null?void 0:a.thumbnail_url,alt:"Course Thumbnail Image"})}),n.jsx("div",{className:"bg-[#313131] flex row-span-2 p-4  text-white",children:n.jsxs("div",{className:"  flex flex-col justify-between ",children:[n.jsx("h3",{className:"text-4xl",children:a==null?void 0:a.title}),n.jsxs("p",{children:["Instructor: ",(h=a==null?void 0:a.tutor)==null?void 0:h.name]}),n.jsxs("p",{children:["Last Updated on ",U(a==null?void 0:a.updated_at)]}),n.jsxs("p",{children:["Language: ",(p=a==null?void 0:a.language)==null?void 0:p.language]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("span",{children:x}),n.jsx($,{className:"px-1",value:x,disabled:!0,allowHalf:!0}),n.jsxs("span",{children:["(",_,")"]})]})]})})]}),n.jsxs("div",{className:`bg-[#666666] rounded-xl p-3 ${(a==null?void 0:a.discount)!==0?"h-20":"h-14"} text-white  flex flex-col justify-between`,children:[(a==null?void 0:a.discount)!==0?n.jsxs("p",{className:"text-center",children:[a==null?void 0:a.discount," % discount"]}):"",n.jsxs("p",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("span",{className:"w-5 h-5 bg-white rounded-full relative",children:n.jsx("span",{className:"w-3 h-3 bg-[#FF8F18] rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})}),n.jsxs("span",{children:["₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100," Only"]})]}),n.jsxs("span",{className:"bg-[#00B73D] px-2 py-1 rounded-md",children:[(a==null?void 0:a.price)*(a==null?void 0:a.discount)/100," Saved"]})]})]})]}),n.jsxs("div",{className:"p-6 font-bold",children:[n.jsxs("p",{className:"text-2xl flex justify-between items-center",children:[n.jsx("span",{children:"Summary"}),n.jsxs("div",{className:"flex",children:[!(a!=null&&a.is_enrolled)&&n.jsx("div",{className:"flex items-center",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{id:"useCoins",type:"checkbox",value:d,onChange:e=>b(e.target.checked),className:"accent-[#F68713] h-4 w-4 transform scale-150"}),n.jsx("label",{htmlFor:"useCoins",className:"mx-3 text-xl",children:"Use My Coins"})]})}),a!=null&&a.is_enrolled?n.jsx(I,{className:"border-2 border-black rounded-3xl bg-[#FF8400] px-3 py-1 text-lg",to:`/course/view/${a==null?void 0:a.id}/module/${(u=a==null?void 0:a.modules[0])==null?void 0:u.id}`,children:"View Now"}):n.jsx("button",{onClick:L,disabled:j,className:"border-2 border-black rounded-3xl bg-[#FF8400] px-3 py-1 text-lg",children:a!=null&&a.is_paid?"Purchase Now":"Enroll Now"})]})]}),n.jsxs("p",{className:"text-xl ",children:["Total: ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100]}),n.jsxs("p",{children:["No refunds or credits for partial course periods unless required by law. Your course access begins immediately upon purchase with an initial charge of ₹ ",(a==null?void 0:a.price)*(100-(a==null?void 0:a.discount))/100,'. To avoid additional charges, cancel before the start of any future billing periods. By clicking "Start Course" you agree to our Terms and authorize recurring charges for future access.']})]})]})};export{sa as default};
